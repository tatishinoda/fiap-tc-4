# Verificar se gitleaks estÃ¡ instalado
if ! command -v gitleaks &> /dev/null; then
    echo "âŒ ERRO: Gitleaks nÃ£o estÃ¡ instalado!"
    echo "ğŸ“¦ Instale com: brew install gitleaks"
    exit 1
fi

# Rodar Gitleaks nos arquivos staged
echo "ğŸ” Verificando secrets com Gitleaks..."
gitleaks protect --staged --verbose

if [ $? -eq 0 ]; then
    echo "âœ… Nenhum secret detectado. Commit permitido!"
    exit 0
else
    echo ""
    echo "ğŸš¨ =========================================="
    echo "ğŸš¨  COMMIT BLOQUEADO!"
    echo "ğŸš¨ =========================================="
    echo ""
    echo "âŒ Gitleaks detectou possÃ­veis secrets ou credenciais nos arquivos."
    echo ""
    echo "ğŸ“‹ PrÃ³ximos passos:"
    echo "   1. Revise os arquivos listados acima"
    echo "   2. Remova as credenciais expostas"
    echo "   3. Use variÃ¡veis de ambiente (.env)"
    echo "   4. Certifique-se de que .env estÃ¡ no .gitignore"
    echo ""
    exit 1
fi
